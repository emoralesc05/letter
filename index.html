<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Carta Romántica</title>

<style>
body{
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  font-family:"Courier New", monospace;
  overflow:hidden;
  position:relative;
  background:#e6d3a3;
}

/* TEXTURA PAPEL ANTIGUO */
body::before{
  content:"";
  position:absolute;
  inset:0;
  background-image:url("https://www.transparenttextures.com/patterns/aged-paper.png");
  opacity:0.6;
  z-index:-2;
}

/* HALO */
body::after{
  content:"";
  position:absolute;
  inset:0;
  background:radial-gradient(
    circle at center,
    rgba(255,245,210,0.9) 0%,
    rgba(240,220,170,0.7) 35%,
    rgba(214,190,140,0.9) 65%,
    rgba(190,160,110,1) 100%
  );
  z-index:-1;
}

/* CONTENEDOR */
.container{
  position:relative;
  perspective:1500px;
  transition:transform .8s ease;
}

/* SOBRE */
.carta{
  width:360px;
  height:240px;
  background:#f4e7c5;
  position:relative;
  border-radius:6px;
  box-shadow:0 30px 60px rgba(0,0,0,.3);
  cursor:pointer;
  transition:transform .4s ease, box-shadow .4s ease;
}

/* HOVER */
.carta:hover{
  transform:scale(1.06);
  box-shadow:0 40px 80px rgba(0,0,0,.35);
}

.carta::before{
  content:"";
  position:absolute;
  inset:0;
  background-image:url("https://www.transparenttextures.com/patterns/paper-fibers.png");
  opacity:.4;
  pointer-events:none;
}

/* SOLAPA */
.tapa{
  position:absolute;
  width:100%;
  height:100%;
  clip-path:polygon(0 0,100% 0,50% 55%);
  background:#e8d9b0;
  transform-origin:top;
  transition:transform 1s ease;
  z-index:3;
}

.carta.abierta .tapa{
  transform:rotateX(-180deg);
}

/* HOJA */
.mensaje{
  position:absolute;
  width:88%;
  height:85%;
  left:6%;
  top:8%;
  background:#fffaf0;
  padding:20px;
  box-sizing:border-box;
  border-radius:4px;
  box-shadow:0 15px 30px rgba(0,0,0,.15);
  transform:translateY(100%) rotate(-2deg);
  opacity:0;
  transition:all 1s cubic-bezier(.22,.61,.36,1);
  z-index:2;
  overflow-y:auto;
  line-height:1.6;
}

.carta.abierta .mensaje{
  transform:translateY(0) rotate(0deg);
  opacity:1;
}

/* Scroll elegante */
.mensaje::-webkit-scrollbar{
  width:6px;
}
.mensaje::-webkit-scrollbar-thumb{
  background:#d6c38d;
  border-radius:4px;
}

/* SOMBRA */
.sombra{
  position:absolute;
  width:60%;
  height:25px;
  bottom:-35px;
  left:20%;
  background:radial-gradient(ellipse at center,
  rgba(0,0,0,.35) 0%,
  rgba(0,0,0,.15) 50%,
  transparent 80%);
  filter:blur(10px);
  border-radius:50%;
  transition:.8s ease;
}

.carta.abierta + .sombra{
  transform:scale(1.2);
  opacity:.8;
}

/* CURSOR */
#texto::after{
  content:"|";
  animation:blink 1s infinite;
}

@keyframes blink{
  50%{opacity:0;}
}

/* PARTICULAS */
.particula{
  position:absolute;
  width:8px;
  height:8px;
  border-radius:50%;
  pointer-events:none;
  animation:volar 1.6s ease-out forwards;
}

@keyframes volar{
  to{
    transform:translate(var(--x), var(--y));
    opacity:0;
  }
}

/* TEMBLOR */
@keyframes shake{
  0%{transform:rotate(0deg);}
  25%{transform:rotate(.8deg);}
  50%{transform:rotate(-.8deg);}
  75%{transform:rotate(.8deg);}
  100%{transform:rotate(0deg);}
}

.carta.temblar{
  animation:shake .35s ease;
}
</style>
</head>

<body>

<div class="container" id="container">
  <div class="carta" id="carta" onclick="abrirCarta()">
    <div class="tapa"></div>
    <div class="mensaje">
      <div id="texto"></div>
    </div>
  </div>
  <div class="sombra"></div>
</div>

<script>
const mensajeCompleto = `
Hay palabras que nunca supe cómo decir en voz alta.

Pero el silencio también pesa,
y el papel siempre ha sabido sostener lo que el corazón tiembla al pronunciar.

Desde hace tiempo he querido escribir esto.
No como una confesión impulsiva,
sino como una verdad que fue creciendo despacio,
como las cosas importantes.

A veces pienso en todos los momentos pequeños.
Las miradas que duraron un segundo más de lo necesario.
Las risas que parecían insignificantes.
Los silencios que lo decían todo.

Si esta carta parece larga,
es porque lo que siento no cabe en pocas líneas.

Y si alguna vez dudé en escribirla,
fue solo porque temía que el papel no fuera suficiente
para contener algo tan grande.

Pero aquí estoy.

Escribiendo.
`;

let primeraLinea = mensajeCompleto.split("\n")[0];
let resto = mensajeCompleto.slice(primeraLinea.length);
let i = 0;

function escribirPrimeraParte(){
  if(i < primeraLinea.length){
    document.getElementById("texto").innerHTML += primeraLinea.charAt(i);
    i++;
    setTimeout(escribirPrimeraParte, 40);
  } else {
    mostrarResto();
  }
}

function mostrarResto(){
  const contenedor = document.getElementById("texto");
  const restoDiv = document.createElement("div");
  restoDiv.style.opacity = 0;
  restoDiv.style.transition = "opacity 2s ease";
  restoDiv.innerText = resto;
  contenedor.appendChild(restoDiv);

  setTimeout(()=>{
    restoDiv.style.opacity = 1;
  }, 300);
}

function abrirCarta(){
  const carta=document.getElementById("carta");
  const container=document.getElementById("container");

  if(carta.classList.contains("abierta"))return;

  carta.classList.add("temblar");

  setTimeout(()=>{
    carta.classList.remove("temblar");
    carta.classList.add("abierta");
    container.style.transform="scale(1.05)";
    escribirPrimeraParte();
    lanzarParticulas(carta);
  },350);
}

function lanzarParticulas(carta){
  const rect=carta.getBoundingClientRect();
  const cx=rect.left+rect.width/2;
  const cy=rect.top+rect.height/2;

  for(let j=0;j<20;j++){
    const p=document.createElement("div");
    p.classList.add("particula");
    p.style.left=cx+"px";
    p.style.top=cy+"px";

    const x=(Math.random()*220-110)+"px";
    const y=(Math.random()*-220)+"px";

    p.style.setProperty("--x",x);
    p.style.setProperty("--y",y);

    p.style.background=["#fff3c4","#fff8dc","#f5e6a3","#ffe27a"][Math.floor(Math.random()*4)];

    document.body.appendChild(p);
    setTimeout(()=>p.remove(),1600);
  }
}
</script>

</body>
</html>
